webpackJsonp([2],{821:function(t,n,e){"use strict";function l(t){return a["ɵvid"](0,[(t()(),a["ɵeld"](0,0,null,null,0,"canvas",[],null,null,null,null,null))],null,null)}function i(t){return a["ɵvid"](0,[(t()(),a["ɵeld"](0,0,null,null,1,"p",[],null,null,null,null,null)),(t()(),a["ɵted"](1,null,[""," -\n        ",""]))],null,function(t,n){var e=n.component;t(n,1,0,e.customer.customerDetails.cardCode,e.customer.customerDetails.cardName)})}function o(t){return a["ɵvid"](0,[a["ɵqud"](402653184,1,{signaturePad:0}),(t()(),a["ɵted"](-1,null,["\n"])),(t()(),a["ɵeld"](2,0,null,null,10,"ion-header",[],null,null,null,null,null)),a["ɵdid"](3,16384,null,0,S.a,[N.a,a.ElementRef,a.Renderer,[2,k.a]],null,null),(t()(),a["ɵted"](-1,null,["\n  "])),(t()(),a["ɵeld"](5,0,null,null,6,"ion-navbar",[["class","toolbar"],["color","navbar"],["text-center",""]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,O.b,O.a)),a["ɵdid"](6,49152,null,0,T.a,[A.a,[2,k.a],[2,L.a],N.a,a.ElementRef,a.Renderer],{color:[0,"color"]},null),(t()(),a["ɵted"](-1,3,["\n    "])),(t()(),a["ɵeld"](8,0,null,3,2,"ion-title",[],null,null,null,I.b,I.a)),a["ɵdid"](9,49152,null,0,W.a,[N.a,a.ElementRef,a.Renderer,[2,B.a],[2,T.a]],null,null),(t()(),a["ɵted"](10,0,["\n      "," - Acknowledgement\n    "])),(t()(),a["ɵted"](-1,3,["\n  "])),(t()(),a["ɵted"](-1,null,["\n"])),(t()(),a["ɵted"](-1,null,["\n\n"])),(t()(),a["ɵeld"](14,0,null,null,94,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,U.b,U.a)),a["ɵdid"](15,4374528,null,0,F.a,[N.a,j.a,V.a,a.ElementRef,a.Renderer,A.a,q.a,a.NgZone,[2,k.a],[2,L.a]],null,null),(t()(),a["ɵted"](-1,1,["\n\n  "])),(t()(),a["ɵeld"](17,0,null,1,16,"ion-row",[["class","row"]],null,null,null,null,null)),a["ɵdid"](18,16384,null,0,H.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵeld"](20,0,null,null,12,"ion-col",[["class","pj-full-width-border col"],["col-12",""],["no-margin",""]],null,null,null,null,null)),a["ɵdid"](21,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n      "])),(t()(),a["ɵand"](16777216,null,null,1,null,i)),a["ɵdid"](24,16384,null,0,J.j,[a.ViewContainerRef,a.TemplateRef],{ngIf:[0,"ngIf"]},null),(t()(),a["ɵted"](-1,null,["\n      "])),(t()(),a["ɵeld"](26,0,null,null,1,"span",[["class","pj-info-letters"]],null,null,null,null,null)),(t()(),a["ɵted"](27,null,[""," | "," | Due Date: ",""])),(t()(),a["ɵeld"](28,0,null,null,0,"br",[],null,null,null,null,null)),(t()(),a["ɵted"](-1,null,["\n      "])),(t()(),a["ɵeld"](30,0,null,null,1,"span",[["class","pj-info-letters"]],null,null,null,null,null)),(t()(),a["ɵted"](31,null,["Ref#: ",""])),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵted"](-1,null,["\n  "])),(t()(),a["ɵted"](-1,1,["\n\n  "])),(t()(),a["ɵeld"](35,0,null,1,1,"div",[["class","title"]],null,null,null,null,null)),(t()(),a["ɵted"](-1,null,["Please draw your Signature"])),(t()(),a["ɵted"](-1,1,["\n\n  "])),(t()(),a["ɵeld"](38,0,null,1,16,"ion-row",[["class","row"]],null,null,null,null,null)),a["ɵdid"](39,16384,null,0,H.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵeld"](41,0,null,null,1,"ion-col",[["class","col"],["col-2",""]],null,null,null,null,null)),a["ɵdid"](42,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n      "])),(t()(),a["ɵeld"](44,0,null,null,6,"ion-col",[["class","col"],["col-8",""]],null,null,null,null,null)),a["ɵdid"](45,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n        "])),(t()(),a["ɵeld"](47,0,null,null,2,"button",[["color","danger"],["full",""],["ion-button",""]],null,[[null,"click"]],function(t,n,e){var l=!0;if("click"===n){l=!1!==t.component.clearPad()&&l}return l},G.b,G.a)),a["ɵdid"](48,1097728,null,0,Y.a,[[8,""],N.a,a.ElementRef,a.Renderer],{color:[0,"color"],full:[1,"full"]},null),(t()(),a["ɵted"](-1,0,["Clear"])),(t()(),a["ɵted"](-1,null,["\n      "])),(t()(),a["ɵted"](-1,null,["\n      "])),(t()(),a["ɵeld"](52,0,null,null,1,"ion-col",[["class","col"],["col-2",""]],null,null,null,null,null)),a["ɵdid"](53,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n  "])),(t()(),a["ɵted"](-1,1,["\n\n  "])),(t()(),a["ɵeld"](56,0,null,1,17,"ion-row",[["class","row"]],null,null,null,null,null)),a["ɵdid"](57,278528,null,0,J.h,[a.IterableDiffers,a.KeyValueDiffers,a.ElementRef,a.Renderer2],{ngClass:[0,"ngClass"]},null),a["ɵpod"](58,{"drawing-active":0}),a["ɵdid"](59,16384,null,0,H.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵeld"](61,0,null,null,1,"ion-col",[["class","col"]],null,null,null,null,null)),a["ɵdid"](62,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵeld"](64,0,null,null,5,"ion-col",[["class","col"]],null,null,null,null,null)),a["ɵdid"](65,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n      "])),(t()(),a["ɵeld"](67,0,null,null,1,"signature-pad",[],null,[[null,"onBeginEvent"],[null,"onEndEvent"]],function(t,n,e){var l=!0,i=t.component;if("onBeginEvent"===n){l=!1!==i.drawStart()&&l}if("onEndEvent"===n){l=!1!==i.drawComplete()&&l}return l},l,K)),a["ɵdid"](68,1097728,[[1,4]],0,s.SignaturePad,[a.ElementRef],{options:[0,"options"]},{onBeginEvent:"onBeginEvent",onEndEvent:"onEndEvent"}),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵeld"](71,0,null,null,1,"ion-col",[["class","col"]],null,null,null,null,null)),a["ɵdid"](72,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n\n  "])),(t()(),a["ɵted"](-1,1,["\n\n\n  "])),(t()(),a["ɵeld"](75,0,null,1,16,"ion-row",[["class","row"]],null,null,null,null,null)),a["ɵdid"](76,16384,null,0,H.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵeld"](78,0,null,null,1,"ion-col",[["class","col"],["col-2",""]],null,null,null,null,null)),a["ɵdid"](79,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n      "])),(t()(),a["ɵeld"](81,0,null,null,6,"ion-col",[["class","col"],["col-8",""]],null,null,null,null,null)),a["ɵdid"](82,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n        "])),(t()(),a["ɵeld"](84,0,null,null,2,"button",[["color","primary"],["full",""],["ion-button",""]],null,[[null,"click"]],function(t,n,e){var l=!0;if("click"===n){l=!1!==t.component.savePad()&&l}return l},G.b,G.a)),a["ɵdid"](85,1097728,null,0,Y.a,[[8,""],N.a,a.ElementRef,a.Renderer],{color:[0,"color"],full:[1,"full"]},null),(t()(),a["ɵted"](-1,0,["Save"])),(t()(),a["ɵted"](-1,null,["\n      "])),(t()(),a["ɵted"](-1,null,["\n      "])),(t()(),a["ɵeld"](89,0,null,null,1,"ion-col",[["class","col"],["col-2",""]],null,null,null,null,null)),a["ɵdid"](90,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n  "])),(t()(),a["ɵted"](-1,1,["\n\n  "])),(t()(),a["ɵeld"](93,0,null,1,14,"ion-row",[["class","row"]],null,null,null,null,null)),a["ɵdid"](94,16384,null,0,H.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵeld"](96,0,null,null,1,"ion-col",[["class","col"]],null,null,null,null,null)),a["ɵdid"](97,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵeld"](99,0,null,null,4,"ion-col",[["class","col"],["width-80",""]],null,null,null,null,null)),a["ɵdid"](100,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n      "])),(t()(),a["ɵeld"](102,0,null,null,0,"img",[],[[8,"src",4]],null,null,null,null)),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵted"](-1,null,["\n    "])),(t()(),a["ɵeld"](105,0,null,null,1,"ion-col",[["class","col"]],null,null,null,null,null)),a["ɵdid"](106,16384,null,0,z.a,[],null,null),(t()(),a["ɵted"](-1,null,["\n  "])),(t()(),a["ɵted"](-1,1,["\n\n"]))],function(t,n){var e=n.component;t(n,6,0,"navbar");t(n,24,0,null!=e.customer.customerDetails);t(n,48,0,"danger","");t(n,57,0,t(n,58,0,e.isDrawing));t(n,68,0,e.signaturePadOptions);t(n,85,0,"primary","")},function(t,n){var e=n.component;t(n,5,0,a["ɵnov"](n,6)._hidden,a["ɵnov"](n,6)._sbPadding);t(n,10,0,e.invoiceNo);t(n,14,0,a["ɵnov"](n,15).statusbarPadding,a["ɵnov"](n,15)._hasRefresher);t(n,27,0,e.momentjs(e.invoice.invoiceDate).format("DD MMM YY"),"O"==e.invoice.isPaid?"Open":"Close",e.momentjs(e.invoice.dueDate).format("DD MMM YY"));t(n,31,0,e.invoice.invoiceNo);t(n,102,0,e.signature)})}Object.defineProperty(n,"__esModule",{value:!0});var a=e(0),u=e(57),s=e(845),r=e(127),d=e(493),c=e(53),h=e(63),p=e(67),v=this&&this.__decorate||function(t,n,e,l){var i,o=arguments.length,a=o<3?n:null===l?l=Object.getOwnPropertyDescriptor(n,e):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,n,e,l);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(a=(o<3?i(a):o>3?i(n,e,a):i(n,e))||a);return o>3&&a&&Object.defineProperty(n,e,a),a},f=this&&this.__metadata||function(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)},g=function(){function t(t,n,e,l,i){this.navCtrl=t,this.restService=n,this.navParams=e,this.commonUtility=l,this.databaseProvider=i,this.signature="",this.isDrawing=!1,this.momentjs=d,this.customer={customerDetails:{}},this.fromDate="",this.invoiceNo="",this.invoice={},this.signaturePadOptions={minWidth:2,canvasWidth:400,canvasHeight:500,backgroundColor:"#f6fbff",penColor:"#666a73"}}return t.prototype.ionViewDidEnter=function(){console.log("ionViewDidEnter SignaturePad"),this.signaturePad.clear(),this.invoice=this.navParams.get("invoice"),this.invoiceNo=this.invoice.invoiceNo,this.customer=this.navParams.get("customer"),this.signature=this.navParams.get("signature"),this.fromDate=this.navParams.get("fromDate"),console.log("Invoice No. = "+this.invoiceNo+", Signature = "+this.signature)},t.prototype.drawComplete=function(){this.isDrawing=!1},t.prototype.drawStart=function(){this.isDrawing=!0},t.prototype.savePad=function(){var t=this,n=this.signaturePad.toDataURL();if(console.log("Signature to Save = "+n),this.commonUtility.isNetworkPresent()){var e=c.a.API_BASE_URL+c.a.API_ENDPOINT_CUST_DTLS+c.a.URL_SEPARATOR+this.invoiceNo+c.a.URL_SEPARATOR+c.a.API_ENDPOINT_INVOICE_ACKNOWLEDGEMENT,l={signature:n};console.log("invoiceAcknowledgementApiEndpoint = "+e+", Data = "+JSON.stringify(l)),this.restService.postDetails(e,l).subscribe(function(e){console.log("Response = "+JSON.stringify(e)),t.updateInvoiceDetailsAndReturn(n)},function(n){console.log("Error = "+JSON.stringify(n)),t.commonUtility.presentErrorToast("Could Not Save Acknowledgement. Please try again")})}else{var i={invoiceNo:this.invoice.invoiceNo,signature:n,invoice:this.invoice};this.databaseProvider.getItem(c.a.CONFIG_NM_ACK_INV_OFFLINE).then(function(e){var l=[];e.rows.length>0&&(l=JSON.parse(e.rows.item(0).data)),l.push(i),t.databaseProvider.setItem(c.a.CONFIG_NM_ACK_INV_OFFLINE,JSON.stringify(l)),t.updateInvoiceDetailsAndReturn(n)}).catch(function(t){console.log("Error = "+JSON.stringify(t))})}},t.prototype.updateInvoiceDetailsAndReturn=function(t){this.invoice.signature=t,this.commonUtility.replaceCustomerInvoice(this.customer,this.invoice),this.signaturePad.clear(),this.navCtrl.pop(),this.navCtrl.pop(),this.navCtrl.push("InvoiceDetailsPage",{customer:this.customer,fromDate:this.fromDate,invoice:this.invoice})},t.prototype.clearPad=function(){this.signaturePad.clear()},v([Object(a.ViewChild)(s.SignaturePad),f("design:type",s.SignaturePad)],t.prototype,"signaturePad",void 0),t=v([Object(a.Component)({selector:"page-signaturepad",templateUrl:"signaturepad.html"}),f("design:paramtypes",[u.n,r.a,u.o,h.a,p.a])],t)}(),m=e(851),y=this&&this.__decorate||function(t,n,e,l){var i,o=arguments.length,a=o<3?n:null===l?l=Object.getOwnPropertyDescriptor(n,e):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,n,e,l);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(a=(o<3?i(a):o>3?i(n,e,a):i(n,e))||a);return o>3&&a&&Object.defineProperty(n,e,a),a},_=function(){function t(){}return t=y([Object(a.NgModule)({declarations:[g],imports:[m.SignaturePadModule,u.i.forChild(g)]})],t)}(),w=e(194),P=e(195),E=e(196),D=e(197),x=e(198),b=e(199),C=e(200),R=e(201),M=e(202),S=e(87),N=e(3),k=e(7),O=e(492),T=e(37),A=e(12),L=e(29),I=e(204),W=e(64),B=e(40),U=e(203),F=e(30),j=e(6),V=e(13),q=e(33),H=e(129),z=e(128),J=e(15),G=e(39),Y=e(27),K=a["ɵcrt"]({encapsulation:2,styles:[],data:{}}),X=(a["ɵccf"]("signature-pad",s.SignaturePad,function(t){return a["ɵvid"](0,[(t()(),a["ɵeld"](0,0,null,null,1,"signature-pad",[],null,null,null,l,K)),a["ɵdid"](1,1097728,null,0,s.SignaturePad,[a.ElementRef],null,null)],null,null)},{options:"options"},{onBeginEvent:"onBeginEvent",onEndEvent:"onEndEvent"},[]),e(16)),Z=a["ɵcrt"]({encapsulation:2,styles:[],data:{}}),Q=a["ɵccf"]("page-signaturepad",g,function(t){return a["ɵvid"](0,[(t()(),a["ɵeld"](0,0,null,null,1,"page-signaturepad",[],null,null,null,o,Z)),a["ɵdid"](1,49152,null,0,g,[L.a,r.a,X.a,h.a,p.a],null,null)],null,null)},{},{},[]),$=e(20),tt=e(126),nt=e(51);e.d(n,"SignaturepadPageModuleNgFactory",function(){return et});var et=a["ɵcmf"](_,[],function(t){return a["ɵmod"]([a["ɵmpd"](512,a.ComponentFactoryResolver,a["ɵCodegenComponentFactoryResolver"],[[8,[w.a,P.a,E.a,D.a,x.a,b.a,C.a,R.a,M.a,Q]],[3,a.ComponentFactoryResolver],a.NgModuleRef]),a["ɵmpd"](4608,J.l,J.k,[a.LOCALE_ID,[2,J.u]]),a["ɵmpd"](4608,$.q,$.q,[]),a["ɵmpd"](4608,$.d,$.d,[]),a["ɵmpd"](512,m.SignaturePadModule,m.SignaturePadModule,[]),a["ɵmpd"](512,J.b,J.b,[]),a["ɵmpd"](512,$.o,$.o,[]),a["ɵmpd"](512,$.g,$.g,[]),a["ɵmpd"](512,$.m,$.m,[]),a["ɵmpd"](512,tt.a,tt.a,[]),a["ɵmpd"](512,tt.b,tt.b,[]),a["ɵmpd"](512,_,_,[]),a["ɵmpd"](256,nt.a,g,[])])})},845:function(t,n,e){"use strict";var l=e(0),i=function(){function t(t){this.elementRef=t,this.options=this.options||{},this.onBeginEvent=new l.EventEmitter,this.onEndEvent=new l.EventEmitter}return t.prototype.ngAfterContentInit=function(){var t=e(860).default,n=this.elementRef.nativeElement.querySelector("canvas");this.options.canvasHeight&&(n.height=this.options.canvasHeight),this.options.canvasWidth&&(n.width=this.options.canvasWidth),this.signaturePad=new t(n,this.options),this.signaturePad.onBegin=this.onBegin.bind(this),this.signaturePad.onEnd=this.onEnd.bind(this)},t.prototype.resizeCanvas=function(){var t=Math.max(window.devicePixelRatio||1,1),n=this.signaturePad._canvas;n.width=n.offsetWidth*t,n.height=n.offsetHeight*t,n.getContext("2d").scale(t,t),this.signaturePad.clear()},t.prototype.toData=function(){return this.signaturePad.toData()},t.prototype.fromData=function(t){this.signaturePad.fromData(t)},t.prototype.toDataURL=function(t,n){return this.signaturePad.toDataURL(t,n)},t.prototype.fromDataURL=function(t,n){void 0===n&&(n={}),!n.hasOwnProperty("height")&&this.options.canvasHeight&&(n.height=this.options.canvasHeight),!n.hasOwnProperty("width")&&this.options.canvasWidth&&(n.width=this.options.canvasWidth),this.signaturePad.fromDataURL(t,n)},t.prototype.clear=function(){this.signaturePad.clear()},t.prototype.isEmpty=function(){return this.signaturePad.isEmpty()},t.prototype.off=function(){this.signaturePad.off()},t.prototype.on=function(){this.signaturePad.on()},t.prototype.set=function(t,n){switch(t){case"canvasHeight":this.signaturePad._canvas.height=n;break;case"canvasWidth":this.signaturePad._canvas.width=n;break;default:this.signaturePad[t]=n}},t.prototype.onBegin=function(){this.onBeginEvent.emit(!0)},t.prototype.onEnd=function(){this.onEndEvent.emit(!0)},t.prototype.queryPad=function(){return this.signaturePad},t.decorators=[{type:l.Component,args:[{template:"<canvas></canvas>",selector:"signature-pad"}]}],t.ctorParameters=[{type:l.ElementRef}],t.propDecorators={options:[{type:l.Input}],onBeginEvent:[{type:l.Output}],onEndEvent:[{type:l.Output}]},t}();n.SignaturePad=i},851:function(t,n,e){"use strict";var l=e(0),i=e(845),o=function(){function t(){}return t.decorators=[{type:l.NgModule,args:[{imports:[],declarations:[i.SignaturePad],exports:[i.SignaturePad]}]}],t.ctorParameters=[],t}();n.SignaturePadModule=o},860:function(t,n,e){"use strict";function l(t,n,e){this.x=t,this.y=n,this.time=e||(new Date).getTime()}function i(t,n,e,l){this.startPoint=t,this.control1=n,this.control2=e,this.endPoint=l}function o(t,n){var e=this,l=n||{};this.velocityFilterWeight=l.velocityFilterWeight||.7,this.minWidth=l.minWidth||.5,this.maxWidth=l.maxWidth||2.5,this.throttle="throttle"in l?l.throttle:16,this.minDistance="minDistance"in l?l.minDistance:5,this._strokeMoveUpdate=this.throttle?function(t,n,e){var l,i,o,a=null,u=0;e||(e={});var s=function(){u=!1===e.leading?0:Date.now(),a=null,o=t.apply(l,i),a||(l=i=null)};return function(){var r=Date.now();u||!1!==e.leading||(u=r);var d=n-(r-u);return l=this,i=arguments,d<=0||d>n?(a&&(clearTimeout(a),a=null),u=r,o=t.apply(l,i),a||(l=i=null)):a||!1===e.trailing||(a=setTimeout(s,d)),o}}(o.prototype._strokeUpdate,this.throttle):o.prototype._strokeUpdate,this.dotSize=l.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=l.penColor||"black",this.backgroundColor=l.backgroundColor||"rgba(0,0,0,0)",this.onBegin=l.onBegin,this.onEnd=l.onEnd,this._canvas=t,this._ctx=t.getContext("2d"),this.clear(),this._handleMouseDown=function(t){1===t.which&&(e._mouseButtonDown=!0,e._strokeBegin(t))},this._handleMouseMove=function(t){e._mouseButtonDown&&e._strokeMoveUpdate(t)},this._handleMouseUp=function(t){1===t.which&&e._mouseButtonDown&&(e._mouseButtonDown=!1,e._strokeEnd(t))},this._handleTouchStart=function(t){if(1===t.targetTouches.length){e._strokeBegin(t.changedTouches[0])}},this._handleTouchMove=function(t){t.preventDefault();e._strokeMoveUpdate(t.targetTouches[0])},this._handleTouchEnd=function(t){t.target===e._canvas&&(t.preventDefault(),e._strokeEnd(t))},this.on()}Object.defineProperty(n,"__esModule",{value:!0}),l.prototype.velocityFrom=function(t){return this.time!==t.time?this.distanceTo(t)/(this.time-t.time):1},l.prototype.distanceTo=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},l.prototype.equals=function(t){return this.x===t.x&&this.y===t.y&&this.time===t.time},i.prototype.length=function(){for(var t=0,n=void 0,e=void 0,l=0;l<=10;l+=1){var i=l/10,o=this._point(i,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),a=this._point(i,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(l>0){var u=o-n,s=a-e;t+=Math.sqrt(u*u+s*s)}n=o,e=a}return t},i.prototype._point=function(t,n,e,l,i){return n*(1-t)*(1-t)*(1-t)+3*e*(1-t)*(1-t)*t+3*l*(1-t)*t*t+i*t*t*t},o.prototype.clear=function(){var t=this._ctx,n=this._canvas;t.fillStyle=this.backgroundColor,t.clearRect(0,0,n.width,n.height),t.fillRect(0,0,n.width,n.height),this._data=[],this._reset(),this._isEmpty=!0},o.prototype.fromDataURL=function(t){var n=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=new Image,i=e.ratio||window.devicePixelRatio||1,o=e.width||this._canvas.width/i,a=e.height||this._canvas.height/i;this._reset(),l.src=t,l.onload=function(){n._ctx.drawImage(l,0,0,o,a)},this._isEmpty=!1},o.prototype.toDataURL=function(t){var n;switch(t){case"image/svg+xml":return this._toSVG();default:for(var e=arguments.length,l=Array(e>1?e-1:0),i=1;i<e;i++)l[i-1]=arguments[i];return(n=this._canvas).toDataURL.apply(n,[t].concat(l))}},o.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()},o.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)},o.prototype.isEmpty=function(){return this._isEmpty},o.prototype._strokeBegin=function(t){this._data.push([]),this._reset(),this._strokeUpdate(t),"function"==typeof this.onBegin&&this.onBegin(t)},o.prototype._strokeUpdate=function(t){var n=this._createPoint(t.clientX,t.clientY),e=this._data[this._data.length-1],l=e&&e[e.length-1],i=l&&n.distanceTo(l)<this.minDistance;if(!l||!i){var o=this._addPoint(n),a=o.curve,u=o.widths;a&&u&&this._drawCurve(a,u.start,u.end),this._data[this._data.length-1].push({x:n.x,y:n.y,time:n.time,color:this.penColor})}},o.prototype._strokeEnd=function(t){var n=this.points[0];if(!(this.points.length>2)&&n&&this._drawDot(n),n){var e=this._data[this._data.length-1];n.equals(e[e.length-1])||e.push({x:n.x,y:n.y,time:n.time,color:this.penColor})}"function"==typeof this.onEnd&&this.onEnd(t)},o.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)},o.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)},o.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor},o.prototype._createPoint=function(t,n,e){var i=this._canvas.getBoundingClientRect();return new l(t-i.left,n-i.top,e||(new Date).getTime())},o.prototype._addPoint=function(t){var n=this.points,e=void 0;if(n.push(t),n.length>2){3===n.length&&n.unshift(n[0]);var l=(e=this._calculateCurveControlPoints(n[0],n[1],n[2])).c2;e=this._calculateCurveControlPoints(n[1],n[2],n[3]);var o=new i(n[1],l,e.c1,n[2]),a=this._calculateCurveWidths(o);return n.shift(),{curve:o,widths:a}}return{}},o.prototype._calculateCurveControlPoints=function(t,n,e){var i=t.x-n.x,o=t.y-n.y,a=n.x-e.x,u=n.y-e.y,s=(t.x+n.x)/2,r=(t.y+n.y)/2,d=(n.x+e.x)/2,c=(n.y+e.y)/2,h=Math.sqrt(i*i+o*o),p=Math.sqrt(a*a+u*u),v=p/(h+p),f=n.x-(d+(s-d)*v),g=n.y-(c+(r-c)*v);return{c1:new l(s+f,r+g),c2:new l(d+f,c+g)}},o.prototype._calculateCurveWidths=function(t){var n={start:null,end:null},e=this.velocityFilterWeight*t.endPoint.velocityFrom(t.startPoint)+(1-this.velocityFilterWeight)*this._lastVelocity,l=this._strokeWidth(e);return n.start=this._lastWidth,n.end=l,this._lastVelocity=e,this._lastWidth=l,n},o.prototype._strokeWidth=function(t){return Math.max(this.maxWidth/(t+1),this.minWidth)},o.prototype._drawPoint=function(t,n,e){var l=this._ctx;l.moveTo(t,n),l.arc(t,n,e,0,2*Math.PI,!1),this._isEmpty=!1},o.prototype._drawCurve=function(t,n,e){var l=this._ctx,i=e-n,o=Math.floor(t.length());l.beginPath();for(var a=0;a<o;a+=1){var u=a/o,s=u*u,r=s*u,d=1-u,c=d*d,h=c*d,p=h*t.startPoint.x;p+=3*c*u*t.control1.x,p+=3*d*s*t.control2.x;var v=h*t.startPoint.y;v+=3*c*u*t.control1.y,v+=3*d*s*t.control2.y;this._drawPoint(p+=r*t.endPoint.x,v+=r*t.endPoint.y,n+r*i)}l.closePath(),l.fill()},o.prototype._drawDot=function(t){var n=this._ctx,e="function"==typeof this.dotSize?this.dotSize():this.dotSize;n.beginPath(),this._drawPoint(t.x,t.y,e),n.closePath(),n.fill()},o.prototype._fromData=function(t,n,e){for(var i=0;i<t.length;i+=1){var o=t[i];if(o.length>1)for(var a=0;a<o.length;a+=1){var u=o[a],s=new l(u.x,u.y,u.time),r=u.color;if(0===a)this.penColor=r,this._reset(),this._addPoint(s);else if(a!==o.length-1){var d=this._addPoint(s),c=d.curve,h=d.widths;c&&h&&n(c,h,r)}}else{this._reset();e(o[0])}}},o.prototype._toSVG=function(){var t=this,n=this._data,e=this._canvas,l=Math.max(window.devicePixelRatio||1,1),i=e.width/l,o=e.height/l,a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttributeNS(null,"width",e.width),a.setAttributeNS(null,"height",e.height),this._fromData(n,function(t,n,e){var l=document.createElement("path");if(!(isNaN(t.control1.x)||isNaN(t.control1.y)||isNaN(t.control2.x)||isNaN(t.control2.y))){var i="M "+t.startPoint.x.toFixed(3)+","+t.startPoint.y.toFixed(3)+" C "+t.control1.x.toFixed(3)+","+t.control1.y.toFixed(3)+" "+t.control2.x.toFixed(3)+","+t.control2.y.toFixed(3)+" "+t.endPoint.x.toFixed(3)+","+t.endPoint.y.toFixed(3);l.setAttribute("d",i),l.setAttribute("stroke-width",(2.25*n.end).toFixed(3)),l.setAttribute("stroke",e),l.setAttribute("fill","none"),l.setAttribute("stroke-linecap","round"),a.appendChild(l)}},function(n){var e=document.createElement("circle"),l="function"==typeof t.dotSize?t.dotSize():t.dotSize;e.setAttribute("r",l),e.setAttribute("cx",n.x),e.setAttribute("cy",n.y),e.setAttribute("fill",n.color),a.appendChild(e)});var u='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 '+i+" "+o+'" width="'+i+'" height="'+o+'">',s=a.innerHTML;if(void 0===s){var r=document.createElement("dummy"),d=a.childNodes;r.innerHTML="";for(var c=0;c<d.length;c+=1)r.appendChild(d[c].cloneNode(!0));s=r.innerHTML}var h=u+s+"</svg>";return"data:image/svg+xml;base64,"+btoa(h)},o.prototype.fromData=function(t){var n=this;this.clear(),this._fromData(t,function(t,e){return n._drawCurve(t,e.start,e.end)},function(t){return n._drawDot(t)}),this._data=t},o.prototype.toData=function(){return this._data},n.default=o}});